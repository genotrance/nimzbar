[n.global]
output = nimzbar

[n.include]
$output/include
$output/include/zbar
$output/zbar

[n.exclude]
config.h

[n.prepare]
gitremote = "https://github.com/ZBar/ZBar"
gitsparse = """
include/*
zbar/*
"""

[n.post]
reset = true

[n.wildcard]
wildcard.1 = *.nim
regex.1 = """([u]+int[\d]+)_t"""
replace.1 = "$1"

[nimzbar/zbar/config.h]
create = ""

[zbar.h]
preprocess = true
defines = true

flags = "--stdcall --prefix:_"

compile = $output/zbar/*.c

[zbar.nim]
search.1 = "ZBAR_ERR_,"
replace.1 = "ZBAR_ERR_WINAPI,"

search.2 = "proc zbar_scan_rgb24"
comment.2 = 3
